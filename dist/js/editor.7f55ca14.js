(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["editor"],{"124d":function(e,t,c){"use strict";c("bdcd")},"304c":function(e,t,c){"use strict";c("5a44")},4685:function(e,t,c){"use strict";c("479d")},"479d":function(e,t,c){},"47f1":function(e,t,c){},"49d7":function(e,t,c){"use strict";c.r(t);var a=c("3955"),n=c("cf05"),o=c.n(n);const l={class:"editor",id:"editor-layout-main"},i={key:1,class:"final-preview"},s={class:"final-preview-inner"},r={class:"preview-title"},b={class:"iframe-container"},d=["src","height"],p={class:"page-title"},u=Object(a["n"])("img",{alt:"Vue logo",src:o.a,class:"logo-img"},null,-1),O={class:"sidebar-container"},j=Object(a["n"])("p",null,"画布区域",-1),m={key:0},f={key:0},v={key:1},g=Object(a["n"])("p",null,"该元素被锁定，无法编辑",-1),h={key:1},y=Object(a["n"])("p",null,"在画布中选择元素并开始编辑",-1),k={class:"page-settings"};function x(e,t,c,n,o,x){const C=Object(a["S"])("a-spin"),S=Object(a["S"])("context-menu"),q=Object(a["S"])("publish-form"),w=Object(a["S"])("a-drawer"),_=Object(a["S"])("channel-form"),U=Object(a["S"])("a-modal"),T=Object(a["S"])("router-link"),E=Object(a["S"])("input-edit"),I=Object(a["S"])("a-button"),P=Object(a["S"])("a-menu-item"),J=Object(a["S"])("user-profile"),L=Object(a["S"])("a-menu"),R=Object(a["S"])("a-layout-header"),F=Object(a["S"])("a-layout"),W=Object(a["S"])("components-list"),A=Object(a["S"])("a-layout-sider"),N=Object(a["S"])("history-area"),D=Object(a["S"])("EditWrapper"),z=Object(a["S"])("a-layout-content"),B=Object(a["S"])("edit-group"),M=Object(a["S"])("a-empty"),H=Object(a["S"])("a-tab-pane"),$=Object(a["S"])("layer-list"),K=Object(a["S"])("props-table"),V=Object(a["S"])("a-tabs");return Object(a["J"])(),Object(a["m"])("div",l,[e.globalStatus.loading?(Object(a["J"])(),Object(a["k"])(C,{key:0,tip:"读取中",class:"editor-spinner"})):Object(a["l"])("",!0),Object(a["q"])(S,{onOnSelect:t[0]||(t[0]=t=>{e.setActive(t)})}),Object(a["q"])(w,{title:"设置面板",placement:"right",width:"400",closable:!0,visible:e.visible,"onUpdate:visible":t[3]||(t[3]=t=>e.visible=t)},{default:Object(a["fb"])(()=>[Object(a["q"])(q,{isSaving:e.isSaving,isPublishing:e.isPublishing,onPanelClose:t[1]||(t[1]=t=>e.visible=!1),onTriggerPublish:e.publishWork,onTriggerSave:t[2]||(t[2]=t=>e.saveWork(!0))},null,8,["isSaving","isPublishing","onTriggerPublish"])]),_:1},8,["visible"]),e.visible?(Object(a["J"])(),Object(a["m"])("div",i,[Object(a["n"])("div",s,[Object(a["n"])("div",r,Object(a["W"])(e.pageState.title),1),Object(a["n"])("div",b,[Object(a["n"])("iframe",{src:e.previewURL,width:"375",class:"iframe-placeholder",height:e.pageState.props.height?parseInt(e.pageState.props.height)+5:"560",frameBorder:"0"},"\r\n          ",8,d)])])])):Object(a["l"])("",!0),Object(a["q"])(U,{title:"发布成功",visible:e.showModal,"onUpdate:visible":t[4]||(t[4]=t=>e.showModal=t),width:"700px",footer:null},{default:Object(a["fb"])(()=>[Object(a["q"])(_)]),_:1},8,["visible"]),Object(a["q"])(F,null,{default:Object(a["fb"])(()=>[Object(a["q"])(R,{class:"header"},{default:Object(a["fb"])(()=>[Object(a["n"])("div",p,[Object(a["q"])(T,{to:"/"},{default:Object(a["fb"])(()=>[u]),_:1}),Object(a["q"])(E,{value:e.pageState.title,onChange:e.titleChange},{default:Object(a["fb"])(()=>[Object(a["n"])("h4",null,Object(a["W"])(e.pageState.title),1)]),_:1},8,["value","onChange"])]),Object(a["q"])(L,{selectable:!1,theme:"dark",mode:"horizontal",style:{lineHeight:"64px"}},{default:Object(a["fb"])(()=>[Object(a["q"])(P,{key:"1"},{default:Object(a["fb"])(()=>[Object(a["q"])(I,{type:"primary",onClick:e.previewWork},{default:Object(a["fb"])(()=>[Object(a["p"])("预览和设置")]),_:1},8,["onClick"])]),_:1}),Object(a["q"])(P,{key:"2"},{default:Object(a["fb"])(()=>[Object(a["q"])(I,{type:"primary",onClick:t[5]||(t[5]=t=>e.saveWork(!0)),loading:e.isSaving},{default:Object(a["fb"])(()=>[Object(a["p"])("保存")]),_:1},8,["loading"])]),_:1}),Object(a["q"])(P,{key:"3"},{default:Object(a["fb"])(()=>[Object(a["q"])(I,{type:"primary",onClick:e.publishWork,loading:e.isPublishing},{default:Object(a["fb"])(()=>[Object(a["p"])("发布")]),_:1},8,["onClick","loading"])]),_:1}),Object(a["q"])(P,{key:"4"},{default:Object(a["fb"])(()=>[Object(a["q"])(J,{user:e.userInfo,smMode:!0},null,8,["user"])]),_:1})]),_:1})]),_:1})]),_:1}),Object(a["q"])(F,null,{default:Object(a["fb"])(()=>[Object(a["q"])(A,{width:"300",style:{background:"#fff"}},{default:Object(a["fb"])(()=>[Object(a["n"])("div",O,[Object(a["q"])(W,{onOnItemClick:e.onItemCreated},null,8,["onOnItemClick"])])]),_:1}),Object(a["q"])(F,{style:{padding:"0 24px 24px"}},{default:Object(a["fb"])(()=>[Object(a["q"])(z,{class:"preview-container",onMousedown:e.clearSelection},{default:Object(a["fb"])(()=>[j,Object(a["q"])(N),Object(a["n"])("div",{class:Object(a["A"])(["preview-list",{active:"page"===e.activePanel,"canvas-fix":e.canvasFix}]),id:"canvas-area",onClick:t[6]||(t[6]=(...t)=>e.setPageSetting&&e.setPageSetting(...t))},[Object(a["n"])("div",{class:"body-container",style:Object(a["B"])(e.pageState.props)},[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.components,t=>(Object(a["J"])(),Object(a["m"])("div",{key:t.id},[t.isHidden?Object(a["l"])("",!0):(Object(a["J"])(),Object(a["k"])(D,{key:0,id:t.id,editing:e.currentEditing,onActive:e.setActive,onEditing:e.setEditing,onUpdatePosition:e.updatePosition,active:e.currentId===t.id,props:t.props},{default:Object(a["fb"])(()=>[(Object(a["J"])(),Object(a["k"])(Object(a["U"])(t.name),Object(a["y"])(t.props,{isEditing:!0}),null,16))]),_:2},1032,["id","editing","onActive","onEditing","onUpdatePosition","active","props"]))]))),128))],4)],2)]),_:1},8,["onMousedown"])]),_:1}),Object(a["q"])(A,{width:"300",style:{background:"#fff"},class:"settings-panel"},{default:Object(a["fb"])(()=>[Object(a["q"])(V,{type:"card",activeKey:e.activePanel,"onUpdate:activeKey":t[8]||(t[8]=t=>e.activePanel=t)},{default:Object(a["fb"])(()=>[Object(a["q"])(H,{key:"component",tab:"属性设置",class:"no-top-radius"},{default:Object(a["fb"])(()=>[e.currentElement?(Object(a["J"])(),Object(a["m"])("div",m,[e.currentElement.isLocked?(Object(a["J"])(),Object(a["m"])("div",v,[Object(a["q"])(M,null,{description:Object(a["fb"])(()=>[g]),_:1})])):(Object(a["J"])(),Object(a["m"])("div",f,[Object(a["q"])(B,{props:e.currentElement.props},null,8,["props"])]))])):(Object(a["J"])(),Object(a["m"])("div",h,[Object(a["q"])(M,null,{description:Object(a["fb"])(()=>[y]),_:1})]))]),_:1}),Object(a["q"])(H,{key:"layer",tab:"图层设置"},{default:Object(a["fb"])(()=>[Object(a["q"])($,{list:e.components,selectedId:e.currentId,onSelect:t[7]||(t[7]=t=>{e.setActive(t,!0)}),onChange:e.handleChange},null,8,["list","selectedId","onChange"])]),_:1}),Object(a["q"])(H,{key:"page",tab:"页面设置"},{default:Object(a["fb"])(()=>[Object(a["n"])("div",k,[Object(a["q"])(K,{props:e.pageState.props,mutationName:"updatePage",mutationExtraData:{level:"props"},onUpdated:e.adjustHeightOnUpload},null,8,["props","onUpdated"])])]),_:1})]),_:1},8,["activeKey"])]),_:1})]),_:1})])}var C=c("b6f3"),S=c("9a86"),q=c("596a"),w=c("efab"),_=c("919a"),U=c("f7b8");const T={class:"publish-form-container"},E=Object(a["n"])("div",{id:"preview-barcode-container"},null,-1);function I(e,t,c,n,o,l){const i=Object(a["S"])("a-col"),s=Object(a["S"])("a-row"),r=Object(a["S"])("styled-uploader"),b=Object(a["S"])("a-input"),d=Object(a["S"])("a-form-item"),p=Object(a["S"])("a-button"),u=Object(a["S"])("a-form");return Object(a["J"])(),Object(a["m"])("div",T,[Object(a["q"])(s,{type:"flex",align:"middle",style:{marginBottom:"20px"}},{default:Object(a["fb"])(()=>[Object(a["q"])(i,{span:6},{default:Object(a["fb"])(()=>[Object(a["p"])(" 扫码预览： ")]),_:1}),Object(a["q"])(i,{span:10},{default:Object(a["fb"])(()=>[E]),_:1})]),_:1}),Object(a["q"])(s,{type:"flex",align:"middle",style:{marginBottom:"20px"}},{default:Object(a["fb"])(()=>[Object(a["q"])(i,{span:6},{default:Object(a["fb"])(()=>[Object(a["p"])(" 上传封面： ")]),_:1}),Object(a["q"])(i,{span:10},{default:Object(a["fb"])(()=>[Object(a["q"])(r,{text:"上传封面图",onFileUploaded:e.updateAvatar,uploaded:e.form.uploaded},null,8,["onFileUploaded","uploaded"])]),_:1})]),_:1}),Object(a["q"])(u,{"label-col":{span:6},"wrapper-col":{span:16},model:e.form,rules:e.rules,ref:"publishForm"},{default:Object(a["fb"])(()=>[Object(a["q"])(d,{label:"标题",required:"",name:"title"},{default:Object(a["fb"])(()=>[Object(a["q"])(b,{value:e.form.title,"onUpdate:value":t[0]||(t[0]=t=>e.form.title=t),onChange:t[1]||(t[1]=t=>e.updatePage("title",e.form.title))},null,8,["value"])]),_:1}),Object(a["q"])(d,{label:"副标题",required:"",name:"subTitle"},{default:Object(a["fb"])(()=>[Object(a["q"])(b,{value:e.form.subTitle,"onUpdate:value":t[2]||(t[2]=t=>e.form.subTitle=t),onChange:t[3]||(t[3]=t=>e.updatePage("desc",e.form.subTitle))},null,8,["value"])]),_:1}),Object(a["q"])(d,{"wrapper-col":{span:18,offset:4}},{default:Object(a["fb"])(()=>[Object(a["q"])(p,{type:"primary",onClick:e.checkAndpublish,loading:e.isPublishing},{default:Object(a["fb"])(()=>[Object(a["p"])(" 发布 ")]),_:1},8,["onClick","loading"]),Object(a["q"])(p,{style:{"margin-left":"10px"},onClick:e.saveWork,loading:e.isSaving},{default:Object(a["fb"])(()=>[Object(a["p"])(" 保存 ")]),_:1},8,["onClick","loading"]),Object(a["q"])(p,{style:{"margin-left":"10px"},onClick:e.cancelEdit},{default:Object(a["fb"])(()=>[Object(a["p"])(" 取消 ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])])}const P=e=>(Object(a["M"])("data-v-50de155f"),e=e(),Object(a["K"])(),e),J={class:"styled-upload-component"},L={class:"uploader-container"},R={class:"uploader-container"},F=P(()=>Object(a["n"])("h4",null,"上传中",-1)),W={class:"uploader-container"},A=["src"];function N(e,t,c,n,o,l){const i=Object(a["S"])("FileImageOutlined"),s=Object(a["S"])("LoadingOutlined"),r=Object(a["S"])("uploader");return Object(a["J"])(),Object(a["m"])("div",J,[Object(a["q"])(r,{action:"/utils/upload-img",beforeUpload:e.commonUploadCheck,uploaded:e.uploaded,onFileUploaded:e.handleFileUploaded},{loading:Object(a["fb"])(()=>[Object(a["n"])("div",R,[Object(a["q"])(s,{style:{fontSize:"30px"},spin:""}),F])]),uploaded:Object(a["fb"])(e=>[Object(a["n"])("div",W,[Object(a["n"])("img",{src:e.uploadedData.data.url},null,8,A)])]),default:Object(a["fb"])(()=>[Object(a["n"])("div",L,[Object(a["q"])(i,{style:{fontSize:"30px"}}),Object(a["n"])("h4",null,Object(a["W"])(e.text),1)])]),_:1},8,["beforeUpload","uploaded","onFileUploaded"])])}var D=c("13ec");const z=e=>(Object(a["M"])("data-v-166ffce4"),e=e(),Object(a["K"])(),e),B={class:"file-upload"},M=z(()=>Object(a["n"])("button",{class:"btn btn-primary",disabled:""},"正在上传...",-1)),H=z(()=>Object(a["n"])("button",{class:"btn btn-primary"},"上传成功",-1)),$=z(()=>Object(a["n"])("button",{class:"btn btn-primary"},"点击上传",-1));function K(e,t,c,n,o,l){return Object(a["J"])(),Object(a["m"])("div",B,[Object(a["n"])("div",Object(a["y"])({class:"file-upload-container",onClick:t[0]||(t[0]=Object(a["hb"])((...t)=>e.triggerUpload&&e.triggerUpload(...t),["prevent"]))},e.$attrs),["loading"===e.fileStatus?Object(a["R"])(e.$slots,"loading",{key:0},()=>[M],!0):"success"===e.fileStatus?Object(a["R"])(e.$slots,"uploaded",{key:1,uploadedData:e.uploadedData},()=>[H],!0):Object(a["R"])(e.$slots,"default",{key:2},()=>[$],!0)],16),Object(a["n"])("input",{type:"file",class:"file-input d-none",ref:"fileInput",onChange:t[1]||(t[1]=(...t)=>e.handleFileChange&&e.handleFileChange(...t))},null,544)])}var V=c("07d8"),Q=Object(a["r"])({props:{action:{type:String,required:!0},beforeUpload:{type:Function},uploaded:{type:Object}},inheritAttrs:!1,emits:["file-uploaded","file-uploaded-error"],setup(e,t){const c=Object(a["O"])(null),n=Object(a["O"])(e.uploaded?"success":"ready"),o=Object(a["O"])(e.uploaded);Object(a["db"])(()=>e.uploaded,e=>{e?(n.value="success",o.value=e):n.value="ready"});const l=()=>{c.value&&c.value.click()},i=a=>{const l=a.target;if(l.files){const a=Array.from(l.files);if(e.beforeUpload){const t=e.beforeUpload(a[0]);if(!t)return}n.value="loading";const i=new FormData;i.append("file",a[0]),V["a"].post(e.action,i,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{n.value="success",o.value=e.data,e.data.file=a[0],t.emit("file-uploaded",e.data)}).catch(e=>{n.value="error",t.emit("file-uploaded-error",{error:e})}).finally(()=>{c.value&&(c.value.value="")})}};return{fileInput:c,triggerUpload:l,fileStatus:n,uploadedData:o,handleFileChange:i}}}),G=(c("734c"),c("85dd")),X=c.n(G);const Y=X()(Q,[["render",K],["__scopeId","data-v-166ffce4"]]);var Z=Y,ee=Object(a["r"])({components:{Uploader:Z},props:{text:{type:String,default:"上传背景图片"},uploaded:{type:Object}},emits:["file-uploaded"],setup(e,t){const c=e=>{t.emit("file-uploaded",e)};return{commonUploadCheck:D["b"],handleFileUploaded:c}}});c("8e06");const te=X()(ee,[["render",N],["__scopeId","data-v-50de155f"]]);var ce=te,ae=c("7ef2"),ne=c.n(ae),oe=c("cd49"),le=Object(a["r"])({components:{StyledUploader:ce},props:{isSaving:Boolean,isPublishing:Boolean},emits:["panel-close","trigger-publish","trigger-save"],setup(e,t){const c=Object(C["b"])(),n=Object(a["i"])(()=>c.state.editor.page),{title:o,desc:l,setting:i}=n.value,s=`${oe["baseH5URL"]}/p/preview/${n.value.id}-${n.value.uuid}`,r=Object(a["N"])({title:o||"",subTitle:l||"",uploaded:{data:{url:i&&i.shareImg||"http://vue-maker.oss-cn-hangzhou.aliyuncs.com/vue-marker/5f79389d4737571e2e1dc7cb.png"}}});Object(a["db"])(()=>n.value.title,e=>{e&&(r.title=e)}),Object(a["G"])(()=>{const e=document.getElementById("preview-barcode-container");e&&(e.innerHTML="",new ne.a(e,{text:s,width:120,height:120}))});const b=Object(a["O"])(),d={title:[{required:!0,message:"标题不能为空",trigger:"blur"}],subTitle:[{required:!0,message:"副标题不能为空",trigger:"blur"}]},p=(e,t,a=!1)=>{c.commit("updatePage",{key:e,value:t,level:!!a&&"setting"})},u=e=>{const t=e.data.urls[0];r.uploaded={data:{url:t}},p("shareImg",t,!0)},O=()=>b.value.validate(),j=()=>{O().then(()=>{t.emit("trigger-publish",!0)})},m=()=>{O().then(()=>{t.emit("trigger-save",!0)})},f=()=>{t.emit("panel-close",!0)};return{form:r,rules:d,publishForm:b,checkAndpublish:j,saveWork:m,cancelEdit:f,commonUploadCheck:D["b"],updatePage:p,updateAvatar:u}}});c("c4a4");const ie=X()(le,[["render",I]]);var se=ie;const re={class:"publish-channel-container"},be=["src","alt"],de=["src","alt"],pe=["id"],ue={class:"delete-area"},Oe=Object(a["n"])("div",{id:"channel-barcode-template",class:"barcode-container"},null,-1),je=Object(a["n"])("h4",null,"模版信息",-1),me={class:"template-submit"};function fe(e,t,c,n,o,l){const i=Object(a["S"])("a-col"),s=Object(a["S"])("a-row"),r=Object(a["S"])("a-input"),b=Object(a["S"])("a-button"),d=Object(a["S"])("a-form-item"),p=Object(a["S"])("a-form"),u=Object(a["S"])("a-tab-pane"),O=Object(a["S"])("a-tabs");return Object(a["J"])(),Object(a["m"])("div",re,[Object(a["q"])(s,{style:{marginBottom:"20px"}},{default:Object(a["fb"])(()=>[Object(a["q"])(i,{span:8,class:"left-col"},{default:Object(a["fb"])(()=>[Object(a["p"])(" 封面图 "),Object(a["n"])("img",{src:e.page.coverImg,alt:e.page.title},null,8,be)]),_:1}),Object(a["q"])(i,{span:16,class:"right-col"},{default:Object(a["fb"])(()=>[Object(a["q"])(s,null,{default:Object(a["fb"])(()=>[Object(a["q"])(i,{span:6},{default:Object(a["fb"])(()=>[Object(a["n"])("img",{src:e.page.setting&&e.page.setting.shareImg||"http://vue-maker.oss-cn-hangzhou.aliyuncs.com/vue-marker/5f79389d4737571e2e1dc7cb.png",alt:e.page.title},null,8,de)]),_:1}),Object(a["q"])(i,{span:18,class:"left-gap"},{default:Object(a["fb"])(()=>[Object(a["n"])("h4",null,Object(a["W"])(e.page.title),1),Object(a["n"])("p",null,Object(a["W"])(e.page.desc),1)]),_:1})]),_:1}),Object(a["q"])(O,{type:"card",style:{marginTop:"20px"},onChange:e.tabChange},{default:Object(a["fb"])(()=>[Object(a["q"])(u,{key:"channels",tab:"发布为作品"},{default:Object(a["fb"])(()=>[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.channels,t=>(Object(a["J"])(),Object(a["k"])(s,{key:t.id,class:"channel-item"},{default:Object(a["fb"])(()=>[Object(a["q"])(i,{span:6},{default:Object(a["fb"])(()=>[Object(a["n"])("div",{id:"channel-barcode-"+t.id,class:"barcode-container"},null,8,pe)]),_:2},1024),Object(a["q"])(i,{span:18,class:"left-gap"},{default:Object(a["fb"])(()=>[Object(a["n"])("h4",null,Object(a["W"])(t.name),1),Object(a["q"])(s,null,{default:Object(a["fb"])(()=>[Object(a["q"])(i,{span:18},{default:Object(a["fb"])(()=>[Object(a["q"])(r,{value:e.generateChannelURL(t.id),readonly:!0,id:"channel-url-"+t.id},null,8,["value","id"])]),_:2},1024),Object(a["q"])(i,{span:6},{default:Object(a["fb"])(()=>[Object(a["q"])(b,{class:"copy-button","data-clipboard-target":"#channel-url-"+t.id},{default:Object(a["fb"])(()=>[Object(a["p"])("复制")]),_:2},1032,["data-clipboard-target"])]),_:2},1024)]),_:2},1024)]),_:2},1024),Object(a["n"])("div",ue,[Object(a["q"])(b,{type:"danger",size:"small",onClick:c=>e.deleteChannel(t.id),disabled:e.deleteDisabled},{default:Object(a["fb"])(()=>[Object(a["p"])("删除渠道")]),_:2},1032,["onClick","disabled"])])]),_:2},1024))),128)),Object(a["q"])(p,{layout:"inline",model:e.form,rules:e.rules,ref:"publishForm",style:{marginTop:"20px"}},{default:Object(a["fb"])(()=>[Object(a["q"])(d,{name:"channelName"},{default:Object(a["fb"])(()=>[Object(a["q"])(r,{value:e.form.channelName,"onUpdate:value":t[0]||(t[0]=t=>e.form.channelName=t),placeholder:"渠道名称"},null,8,["value"])]),_:1}),Object(a["q"])(d,null,{default:Object(a["fb"])(()=>[Object(a["q"])(b,{type:"primary",onClick:e.createChannel},{default:Object(a["fb"])(()=>[Object(a["p"])(" 创建新渠道 ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),Object(a["q"])(u,{key:"template",tab:"发布为模版"},{default:Object(a["fb"])(()=>[Object(a["q"])(s,{class:"channel-item"},{default:Object(a["fb"])(()=>[Object(a["q"])(i,{span:6},{default:Object(a["fb"])(()=>[Oe]),_:1}),Object(a["q"])(i,{span:18,class:"left-gap"},{default:Object(a["fb"])(()=>[je,Object(a["q"])(s,null,{default:Object(a["fb"])(()=>[Object(a["q"])(i,{span:18},{default:Object(a["fb"])(()=>[Object(a["q"])(r,{value:e.generateChannelURL(),readonly:!0,id:"channel-url-template"},null,8,["value"])]),_:1}),Object(a["q"])(i,{span:6},{default:Object(a["fb"])(()=>[Object(a["q"])(b,{class:"copy-button","data-clipboard-target":"#channel-url-template"},{default:Object(a["fb"])(()=>[Object(a["p"])("复制")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),Object(a["n"])("div",me,[Object(a["q"])(b,{type:"primary",size:"large",onClick:e.publishTemplate},{default:Object(a["fb"])(()=>[Object(a["p"])(" 发布模版 ")]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["onChange"])]),_:1})]),_:1})])}var ve=c("6a87"),ge=c("a2ea"),he=c.n(ge),ye=Object(a["r"])({emits:["panel-close","publish-success"],setup(e,t){const c=Object(C["b"])(),n=Object(S["d"])(),o=n.params.id,l=Object(a["i"])(()=>c.state.editor.page),i=Object(a["i"])(()=>c.state.editor.channels),s=Object(a["O"])(!1),r=e=>e?`${oe["baseH5URL"]}/p/${l.value.id}-${l.value.uuid}?channel=${e}`:`${oe["baseH5URL"]}/p/${l.value.id}-${l.value.uuid}`,b=e=>{const t=document.getElementById(e?"channel-barcode-"+e:"channel-barcode-template");t&&(t.innerHTML="",new ne.a(t,{text:r(e),width:80,height:80}))};Object(a["G"])(()=>{c.dispatch("getChannels",o);const e=new he.a(".copy-button");e.on("success",e=>{q["a"].success("复制成功",1),e.clearSelection()}),setTimeout(()=>{i.value.forEach(e=>{b(e.id)})},500)}),Object(a["db"])(i,(e,t)=>{if(e.length>t.length&&0!==t.length){const t=Object(ve["a"])(e);t&&b(t.id)}});const d=e=>{"template"!==e||s.value||Object(a["z"])(()=>{b(),s.value=!0})},p=Object(a["N"])({channelName:""}),u=Object(a["O"])(),O={channelName:[{required:!0,message:"标题不能为空",trigger:"blur"}]},j=(e,t)=>{c.commit("updatePage",{key:e,value:t})},m=Object(a["i"])(()=>1===i.value.length),f=async()=>{const e={name:p.channelName,workId:parseInt(o)};try{await u.value.validate(),await c.dispatch("createChannel",e),p.channelName=""}catch(t){return""}},v=e=>{c.dispatch("deleteChannel",e)},g=()=>{c.dispatch("publishTemplate",o).then(()=>{q["a"].success("模版发布成功",1)})},h=()=>{t.emit("panel-close",!0)};return{form:p,rules:O,publishForm:u,cancelEdit:h,commonUploadCheck:D["b"],updatePage:j,page:l,createChannel:f,channels:i,generateChannelURL:r,deleteChannel:v,deleteDisabled:m,tabChange:d,publishTemplate:g}}});c("51af");const ke=X()(ye,[["render",fe]]);var xe=ke;const Ce={class:"history-area"},Se={class:"shortcut-list"},qe={class:"text"},we={class:"bold"},_e={class:"operation-list"};function Ue(e,t,c,n,o,l){const i=Object(a["S"])("a-modal"),s=Object(a["S"])("QuestionOutlined"),r=Object(a["S"])("a-button"),b=Object(a["S"])("a-tooltip"),d=Object(a["S"])("UndoOutlined"),p=Object(a["S"])("RedoOutlined");return Object(a["J"])(),Object(a["m"])("div",Ce,[Object(a["q"])(i,{title:"快捷键操作",visible:e.modalVisible,"onUpdate:visible":t[0]||(t[0]=t=>e.modalVisible=t),footer:null,width:"400px"},{default:Object(a["fb"])(()=>[Object(a["n"])("ul",Se,[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.operationText,(e,t)=>(Object(a["J"])(),Object(a["m"])("li",{key:t,class:"shortcut-list-item"},[Object(a["n"])("span",qe,Object(a["W"])(e.text),1),Object(a["p"])(),Object(a["n"])("span",we,Object(a["W"])(e.shortcut),1)]))),128))])]),_:1},8,["visible"]),Object(a["n"])("div",_e,[Object(a["q"])(b,null,{title:Object(a["fb"])(()=>[Object(a["p"])(" 快捷键提示 ")]),default:Object(a["fb"])(()=>[Object(a["q"])(r,{shape:"circle",onClick:t[1]||(t[1]=t=>e.modalVisible=!0)},{icon:Object(a["fb"])(()=>[Object(a["q"])(s)]),_:1})]),_:1}),Object(a["q"])(b,null,{title:Object(a["fb"])(()=>[Object(a["p"])(" 撤销 ")]),default:Object(a["fb"])(()=>[Object(a["q"])(r,{shape:"circle",onClick:e.undoHistory,disabled:e.undoIsDisabled},{icon:Object(a["fb"])(()=>[Object(a["q"])(d)]),_:1},8,["onClick","disabled"])]),_:1}),Object(a["q"])(b,null,{title:Object(a["fb"])(()=>[Object(a["p"])(" 重做 ")]),default:Object(a["fb"])(()=>[Object(a["q"])(r,{shape:"circle",onClick:e.redoHistory,disabled:e.redoIsDisabled},{icon:Object(a["fb"])(()=>[Object(a["q"])(p)]),_:1},8,["onClick","disabled"])]),_:1})])])}function Te(e){const t=Object(C["b"])();return{copy:()=>{e.value&&(t.commit("copyComponent",e.value),q["a"].success("已拷贝当前图层",1))},paste:()=>{},delete:()=>{e.value&&(t.commit("deleteComponent",e.value),q["a"].success("删除当前图层成功",1))},cancel:()=>{e.value&&t.commit("setActive","")},undo:()=>{const e=Object(a["i"])(()=>t.getters.checkUndoDisable);e.value||t.commit("undo")},redo:()=>{const e=Object(a["i"])(()=>t.getters.checkRedoDisable);e.value||t.commit("redo")},move:(c,a)=>{e.value&&t.commit("moveComponent",{direction:c,amount:a})}}}const Ee={copy:{text:"拷贝图层",shortcut:"⌘C / Ctrl+C"},paste:{text:"粘贴图层",shortcut:"⌘V / Ctrl+V"},delete:{text:"删除图层",shortcut:"Backspace / Delete"},cancel:{text:"取消选中",shortcut:"ESC"},undo:{text:"撤销",shortcut:"⌘Z / Ctrl+Z"},redo:{text:"重做",shortcut:"⌘⇧Z / Ctrl+Shift+Z"},move:{text:"上下左右移动一像素",shortcut:"↑ ↓ → ←"},moveTen:{text:"上下左右移动十像素",shortcut:"Shift + ↑ ↓ → ←"}};var Ie=Object(a["r"])({components:{},setup(){const e=Object(a["O"])(!1),t=Object(C["b"])(),c=Object(a["i"])(()=>t.state.editor.histories),n=Object(a["i"])(()=>t.state.editor.historyIndex),o=Object(a["i"])(()=>t.getters.checkUndoDisable),l=Object(a["i"])(()=>t.getters.checkRedoDisable),i=()=>{t.commit("undo")},s=()=>{t.commit("redo")};return{histories:c,undoHistory:i,redoHistory:s,undoIsDisabled:o,redoIsDisabled:l,historyIndex:n,modalVisible:e,operationText:Ee}}});c("8762");const Pe=X()(Ie,[["render",Ue]]);var Je=Pe;const Le=["data-component-id"],Re={class:"resizers"};function Fe(e,t,c,n,o,l){return Object(a["J"])(),Object(a["m"])("div",{class:Object(a["A"])(["edit-wrapper",{active:e.active}]),onClick:t[5]||(t[5]=(...t)=>e.itemClick&&e.itemClick(...t)),onDblclick:t[6]||(t[6]=(...t)=>e.itemEdit&&e.itemEdit(...t)),ref:"editWrapper",style:Object(a["B"])(e.styleProps),"data-component-id":e.id},[Object(a["n"])("div",{class:"move-wrapper",ref:"moveWrapper",onMousedown:t[0]||(t[0]=(...t)=>e.startMove&&e.startMove(...t))},[Object(a["R"])(e.$slots,"default")],544),Object(a["n"])("div",Re,[Object(a["n"])("div",{class:"resizer top-left",onMousedown:t[1]||(t[1]=t=>e.startResize(t,"top-left"))},null,32),Object(a["n"])("div",{class:"resizer top-right",onMousedown:t[2]||(t[2]=t=>e.startResize(t,"top-right"))},null,32),Object(a["n"])("div",{class:"resizer bottom-left",onMousedown:t[3]||(t[3]=t=>e.startResize(t,"bottom-left"))},null,32),Object(a["n"])("div",{class:"resizer bottom-right",onMousedown:t[4]||(t[4]=t=>e.startResize(t,"bottom-right"))},null,32)])],46,Le)}var We=c("eeae"),Ae=c("546b");const Ne={actionType:"",url:"",height:"",width:"",paddingLeft:"0px",paddingRight:"0px",paddingTop:"0px",paddingBottom:"0px",borderStyle:"none",borderColor:"#000",borderWidth:"0",borderRadius:"0",boxShadow:"0 0 0 #000000",opacity:1,position:"absolute",left:"0",top:"0",right:"0"},De={fontSize:"14px",fontFamily:"",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",lineHeight:"1",textAlign:"center",color:"#000000",backgroundColor:"",...Ne,width:"318px"},ze={imageSrc:"",...Ne},Be={"p-text":{props:{text:"正文内容",...De,fontSize:"14px",width:"125px",height:"36px",left:"97.5px",top:"232px"}},"p-image":{props:{...ze}},"p-shape":{props:{backgroundColor:"",...Ne}}};const Me=Object(We["a"])(Object.keys(De),"actionType","url","text"),He=(e,t=Me)=>Object(a["i"])(()=>Object(Ae["a"])(e,t));var $e=He,Ke=Object(a["r"])({name:"ListWrapper",props:{id:{type:String,required:!0},active:{type:Boolean,default:!1},editing:{type:String},props:{type:Object}},emits:["active","update-position","editing"],setup(e,t){const c=Object(a["N"])({x:0,y:0});let n;const o=Object(a["O"])(null),l=Object(a["O"])(null);let i=!1;const s=$e(e.props||{},["position","top","left","width","height"]),r=Object(a["i"])(()=>e.editing===e.id);Object(a["db"])(r,e=>{e&&o.value&&o.value.focus()});const b=()=>{t.emit("active",e.id)},d=()=>{t.emit("editing",e.id)},p=e=>{const t=document.getElementById("canvas-area"),a=e.clientX-t.offsetLeft-c.x,n=e.clientY-t.offsetTop-c.y+t.scrollTop;return{left:a,top:n}},u=n=>{const l=o.value;c.x=n.clientX-l.getBoundingClientRect().left,c.y=n.clientY-l.getBoundingClientRect().top;const s=e=>{i=!0;const{left:t,top:c}=p(e);l.style.top=c+"px",l.style.left=t+"px"},r=c=>{const{left:n,top:o}=p(c);document.removeEventListener("mousemove",s),i&&(t.emit("update-position",{left:n,top:o,id:e.id}),i=!1),Object(a["z"])(()=>{document.removeEventListener("mouseup",r)})};document.addEventListener("mousemove",s),document.addEventListener("mouseup",r)},O=(e,t,c)=>{const{left:a,right:n,top:o,bottom:l}=c,{pageX:i,pageY:s}=t,r=document.getElementById("canvas-area"),b=i-a,d=s-o,p=n-i,u=l-s,O=i-r.offsetLeft,j=s-r.offsetTop+r.scrollTop;switch(e){case"top-left":return{width:p,height:u,top:j,left:O};case"top-right":return{width:b,height:u,top:j};case"bottom-left":return{width:p,height:d,left:O};case"bottom-right":return{width:b,height:d};default:break}},j=(c,i)=>{const s=o.value,r=l.value,b=r.firstElementChild,d=[s,b],{left:p,right:u,top:j,bottom:m}=s.getBoundingClientRect(),f=e=>{s&&(n=O(i,e,{left:p,right:u,top:j,bottom:m}),d.forEach(e=>{const{style:t}=e;n&&(n.left&&(t.left=n.left+"px"),n.top&&(t.top=n.top+"px"),t.width=n.width+"px",t.height=n.height+"px")}))},v=()=>{document.removeEventListener("mousemove",f),t.emit("update-position",{...n,id:e.id}),Object(a["z"])(()=>{document.removeEventListener("mouseup",v)})};document.addEventListener("mousemove",f),document.addEventListener("mouseup",v)};return{itemClick:b,styleProps:s,startResize:j,editWrapper:o,moveWrapper:l,itemEdit:d,isEditable:r,startMove:u}}});c("124d");const Ve=X()(Ke,[["render",Fe]]);var Qe=Ve;const Ge={class:"create-component-list"},Xe=["onClick"],Ye={class:"component-wrapper"},Ze={key:0,class:"tip-text"},et={class:"uploader-container"},tt=Object(a["n"])("h4",null,"上传图片",-1),ct={class:"uploader-container"},at=Object(a["n"])("h4",null,"上传中",-1),nt={class:"uploader-container"},ot=Object(a["n"])("h4",null,"上传图片",-1),lt={class:"image-list"},it=["onClick"],st={class:"component-wrapper"},rt=["onClick"],bt={class:"component-wrapper"};function dt(e,t,c,n,o,l){const i=Object(a["S"])("FieldStringOutlined"),s=Object(a["S"])("a-tab-pane"),r=Object(a["S"])("FileImageOutlined"),b=Object(a["S"])("LoadingOutlined"),d=Object(a["S"])("uploader"),p=Object(a["S"])("BuildOutlined"),u=Object(a["S"])("a-tabs");return Object(a["J"])(),Object(a["m"])("div",Ge,[Object(a["q"])(u,null,{default:Object(a["fb"])(()=>[Object(a["q"])(s,{key:"1"},{tab:Object(a["fb"])(()=>[Object(a["n"])("span",null,[Object(a["q"])(i),Object(a["p"])(" 文本 ")])]),default:Object(a["fb"])(()=>[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.textList,(t,c)=>(Object(a["J"])(),Object(a["m"])("div",{key:c,onClick:c=>e.onItemClick(t),class:"component-item"},[Object(a["n"])("div",Ye,[(Object(a["J"])(),Object(a["k"])(Object(a["U"])(t.name),Object(a["y"])(t.props,{style:e.generateResetCss(t.name),class:"inside-component"}),null,16,["style"])),t.text?(Object(a["J"])(),Object(a["m"])("span",Ze,Object(a["W"])(t.text),1)):Object(a["l"])("",!0)])],8,Xe))),128))]),_:1}),Object(a["q"])(s,{key:"2"},{tab:Object(a["fb"])(()=>[Object(a["n"])("span",null,[Object(a["q"])(r),Object(a["p"])(" 图片 ")])]),default:Object(a["fb"])(()=>[Object(a["q"])(d,{action:"/utils/upload-img",onFileUploaded:t[0]||(t[0]=t=>{e.handleFileUploaded(t)}),beforeUpload:e.commonUploadCheck},{loading:Object(a["fb"])(()=>[Object(a["n"])("div",ct,[Object(a["q"])(b,{spin:""}),at])]),uploaded:Object(a["fb"])(()=>[Object(a["n"])("div",nt,[Object(a["q"])(r),ot])]),default:Object(a["fb"])(()=>[Object(a["n"])("div",et,[Object(a["q"])(r),tt])]),_:1},8,["beforeUpload"]),Object(a["n"])("div",lt,[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.imageList,(t,c)=>(Object(a["J"])(),Object(a["m"])("div",{key:c,onClick:c=>e.onItemClick(t),class:"component-item item-image"},[Object(a["n"])("div",st,[(Object(a["J"])(),Object(a["k"])(Object(a["U"])(t.name),Object(a["y"])(t.props,{style:e.generateResetCss(t.name),class:"inside-component"}),null,16,["style"]))])],8,it))),128))])]),_:1}),Object(a["q"])(s,{key:"3"},{tab:Object(a["fb"])(()=>[Object(a["n"])("span",null,[Object(a["q"])(p),Object(a["p"])(" 形状 ")])]),default:Object(a["fb"])(()=>[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.shapeList,(t,c)=>(Object(a["J"])(),Object(a["m"])("div",{key:c,onClick:c=>e.onItemClick(t),class:"component-item"},[Object(a["n"])("div",bt,[(Object(a["J"])(),Object(a["k"])(Object(a["U"])(t.name),Object(a["y"])(t.props,{style:e.generateResetCss(t.name),class:"inside-component"}),null,16,["style"]))])],8,rt))),128))]),_:1})]),_:1})])}const pt=Be["p-text"].props,ut=Be["p-image"].props,Ot=Be["p-shape"].props,jt=e=>({position:"static",..."p-shape"!==e&&{height:""}}),mt=[{text:"大标题",fontSize:"30px",fontWeight:"bold",tag:"h2"},{text:"楷体副标题",fontSize:"20px",fontWeight:"bold",fontFamily:'"KaiTi","STKaiti"',tag:"h2"},{text:"正文内容",tag:"p"},{text:"宋体正文内容",tag:"p",fontFamily:'"SimSun","STSong"'},{text:"Arial style",tag:"p",fontFamily:'"Arial", sans-serif'},{text:"Comic Sans",tag:"p",fontFamily:'"Comic Sans MS"'},{text:"Courier New",tag:"p",fontFamily:'"Courier New", monospace'},{text:"Times New Roman",tag:"p",fontFamily:'"Times New Roman", serif'},{text:"链接内容",color:"#1890ff",textDecoration:"underline",tag:"p"},{text:"按钮内容",color:"#ffffff",backgroundColor:"#1890ff",borderWidth:"1px",borderColor:"#1890ff",borderStyle:"solid",borderRadius:"2px",paddingLeft:"10px",paddingRight:"10px",paddingTop:"5px",paddingBottom:"5px",width:"100px",tag:"button",textAlign:"center"}],ft=mt.map(e=>({name:"p-text",props:{...pt,...e}})),vt=["http://static.imooc-lego.com/upload-files/logo-white-735536.png","http://static.imooc-lego.com/upload-files/logo-black-049885.png","http://static.imooc-lego.com/upload-files/528w-0ilmEQMomZ8-108048.png","http://static.imooc-lego.com/upload-files/frame-096161.png","http://static.imooc-lego.com/upload-files/text-449964.png","http://static.imooc-lego.com/upload-files/text2-288504.png","http://static.imooc-lego.com/upload-files/money-664239.png","http://static.imooc-lego.com/upload-files/bag-904186.png","http://static.imooc-lego.com/upload-files/text3-086652.png","http://static.imooc-lego.com/upload-files/text4-145592.png"],gt=vt.map(e=>({name:"p-image",props:{...ut,imageSrc:e,width:"150px"}})),ht=[{backgroundColor:"#efefef",borderWidth:"1px",borderStyle:"solid",borderColor:"#ccc",width:"100px",height:"50px"},{backgroundColor:"#efefef",borderWidth:"1px",borderStyle:"solid",borderColor:"#ccc",borderRadius:"100px",width:"100px",height:"100px"},{backgroundColor:"#efefef",borderWidth:"1px",borderStyle:"solid",borderColor:"#ccc",width:"100px",height:"100px"},{backgroundColor:"#36cfc9",width:"100px",height:"50px"},{backgroundColor:"#40a9ff",borderRadius:"100px",width:"100px",height:"100px"},{backgroundColor:"#9254de",borderWidth:"5px",borderStyle:"solid",borderColor:"#ccc",width:"100px",height:"100px"}],yt=ht.map(e=>({name:"p-shape",props:{...Ot,...e}}));var kt=Object(a["r"])({components:{},name:"components-list",emits:["on-item-click"],setup(e,t){const c=e=>{"upload"!==e.type&&t.emit("on-item-click",e)},a=e=>{const c={name:"p-image",props:{...ut}};q["a"].success("上传成功"),c.props.imageSrc=e.data.urls[0],Object(D["e"])(e.file).then(e=>{const a=300;c.props.width=(e.width>a?a:e.width)+"px",t.emit("on-item-click",c)})};return{textList:ft,imageList:gt,shapeList:yt,onItemClick:c,commonUploadCheck:D["b"],handleFileUploaded:a,generateResetCss:jt}}});c("6067");const xt=X()(kt,[["render",dt]]);var Ct=xt;const St={class:"context-menu-component menu-container",ref:"menuRef"},qt={class:"item-text"},wt={class:"item-shortcut"};function _t(e,t,c,n,o,l){const i=Object(a["S"])("a-menu-item"),s=Object(a["S"])("a-menu");return Object(a["J"])(),Object(a["m"])("div",St,[Object(a["q"])(s,{mode:"vertical",style:{width:"220px",border:"1px solid #ccc"},selectable:!1},{default:Object(a["fb"])(()=>[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.actions,t=>(Object(a["J"])(),Object(a["k"])(i,{key:t.key,onClick:e=>t.action()},{default:Object(a["fb"])(()=>[Object(a["n"])("span",qt,Object(a["W"])(e.operationText[t.key].text),1),Object(a["n"])("span",wt,Object(a["W"])(e.operationText[t.key].shortcut),1)]),_:2},1032,["onClick"]))),128))]),_:1})],512)}var Ut=c("030d"),Tt=Object(a["r"])({emits:["on-select"],setup(e,t){const c=Object(a["O"])(null),n=Object(a["O"])(""),o=Object(Ae["a"])(Te(n),["copy","paste","delete","cancel"]),l=Object(Ut["a"])(o,(e,t)=>({key:t,action:e})),i=e=>{const a=c.value;e.preventDefault();const o=Object(D["a"])(e,"edit-wrapper");if(o){a.style.display="block",a.style.top=e.pageY+"px",a.style.left=e.pageX+"px";const c=o.dataset.componentId;c&&(n.value=c,t.emit("on-select",o.dataset.componentId))}},s=()=>{const e=c.value;e.style.display="none"};return Object(a["G"])(()=>{document.addEventListener("contextmenu",i),document.addEventListener("click",s)}),Object(a["H"])(()=>{document.removeEventListener("contextmenu",i),document.removeEventListener("click",s)}),{menuRef:c,actions:l,operationText:Ee}}});c("aeb2");const Et=X()(Tt,[["render",_t]]);var It=Et;function Pt(e,t,c,n,o,l){const i=Object(a["S"])("prop-table"),s=Object(a["S"])("a-collapse-panel"),r=Object(a["S"])("a-collapse");return Object(a["J"])(),Object(a["k"])(r,{activeKey:e.currentKey,"onUpdate:activeKey":t[0]||(t[0]=t=>e.currentKey=t)},{default:Object(a["fb"])(()=>[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.editGroups,e=>(Object(a["J"])(),Object(a["k"])(s,{key:e.text,header:e.text},{default:Object(a["fb"])(()=>[Object(a["q"])(i,{props:e.props,mutationExtraData:{isProps:!0}},null,8,["props"])]),_:2},1032,["header"]))),128))]),_:1},8,["activeKey"])}c("dc56"),c("558b");var Jt=c("2dda");const Lt={class:"props-table"},Rt=["id"],Ft={key:0,class:"label"};function Wt(e,t,c,n,o,l){const i=Object(a["S"])("render-vnode");return Object(a["J"])(),Object(a["m"])("div",Lt,[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.finalProps,(e,t)=>(Object(a["J"])(),Object(a["m"])("li",{key:t,class:Object(a["A"])(["prop-item",{"no-text":!e.text,"hide-item":e.isHidden}]),id:"item-"+e.key},[e.text?(Object(a["J"])(),Object(a["m"])("span",Ft,Object(a["W"])(e.text)+":",1)):Object(a["l"])("",!0),Object(a["n"])("div",{class:Object(a["A"])("prop-component component-"+e.component)},[e.options?(Object(a["J"])(),Object(a["k"])(Object(a["U"])(e.component),Object(a["y"])({key:1},e.extraProps,{[e.valueProp||""]:e.value},Object(a["X"])(e.events)),{default:Object(a["fb"])(()=>[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.options,(t,c)=>(Object(a["J"])(),Object(a["k"])(Object(a["U"])(e.subComponent),{key:c,value:t.value},{default:Object(a["fb"])(()=>[Object(a["q"])(i,{vNode:t.text},null,8,["vNode"])]),_:2},1032,["value"]))),128))]),_:2},1040)):(Object(a["J"])(),Object(a["k"])(Object(a["U"])(e.component),Object(a["y"])({key:0},e.extraProps,{[e.valueProp||""]:e.value},Object(a["X"])(e.events)),null,16))],2)],10,Rt))),128))])}const At={component:"a-input",eventName:"change",valueProp:"value",intialTransform:e=>e,afterTransform:e=>e},Nt={...At,component:"a-input-number",intialTransform:e=>e?parseInt(e):0,afterTransform:e=>e?e+"px":"0"},Dt=[{text:"宋体",value:'"SimSun","STSong"'},{text:"黑体",value:'"SimHei","STHeiti"'},{text:"楷体",value:'"KaiTi","STKaiti"'},{text:"仿宋",value:'"FangSong","STFangsong"'},{text:"Arial",value:'"Arial", sans-serif'},{text:"Arial Black",value:'"Arial Black", sans-serif'},{text:"Comic Sans MS",value:'"Comic Sans MS"'},{text:"Courier New",value:'"Courier New", monospace'},{text:"Georgia",value:'"Georgia", serif'},{text:"Times New Roman",value:'"Times New Roman", serif'}],zt=Dt.map(e=>({value:e.value,text:Object(a["u"])("span",{style:{fontFamily:e.value}},e.text)})),Bt={text:{...At,component:"textarea-fix",afterTransform:e=>e.target.value,text:"文本",extraProps:{rows:3}},href:{...At,afterTransform:e=>e.target.value,text:"链接"},fontSize:{...Nt,text:"字号"},fontFamily:{...At,component:"a-select",subComponent:"a-select-option",text:"字体",options:[{value:"",text:"无"},...zt]},fontWeight:{...At,component:"icon-switch",intialTransform:e=>"bold"===e,afterTransform:e=>e?"bold":"normal",valueProp:"checked",extraProps:{iconName:"BoldOutlined",tip:"加粗"}},fontStyle:{...At,component:"icon-switch",intialTransform:e=>"italic"===e,afterTransform:e=>e?"italic":"normal",valueProp:"checked",extraProps:{iconName:"ItalicOutlined",tip:"斜体"}},textDecoration:{...At,component:"icon-switch",intialTransform:e=>"underline"===e,afterTransform:e=>e?"underline":"none",valueProp:"checked",extraProps:{iconName:"UnderlineOutlined",tip:"下划线"}},lineHeight:{...At,component:"a-slider",text:"行高",intialTransform:e=>e?parseFloat(e):0,afterTransform:e=>e.toString(),extraProps:{min:0,max:3,step:.1}},textAlign:{...At,component:"a-radio-group",subComponent:"a-radio-button",afterTransform:e=>e.target.value,text:"对齐",options:[{value:"left",text:"左"},{value:"center",text:"中"},{value:"right",text:"右"}]},color:{...At,component:"color-picker",text:"文字颜色"},backgroundColor:{...At,component:"color-picker",text:"背景颜色"},actionType:{...At,component:"a-select",subComponent:"a-select-option",text:"点击",options:[{value:"",text:"无"},{value:"to",text:"跳转到 URL"}]},url:{...At,afterTransform:e=>e.target.value,text:"链接",parent:"actionType"},height:{...At,component:"a-input-number",intialTransform:e=>e?parseInt(e):"",afterTransform:e=>e?e+"px":"",text:"高度"},width:{...At,component:"a-input-number",intialTransform:e=>e?parseInt(e):"",afterTransform:e=>e?e+"px":"",text:"宽度"},paddingLeft:{...Nt,text:"左边距"},paddingRight:{...Nt,text:"右边距"},paddingTop:{...Nt,text:"上边距"},paddingBottom:{...Nt,text:"下边距"},borderStyle:{...At,component:"a-select",subComponent:"a-select-option",text:"边框类型",options:[{value:"none",text:"无"},{value:"solid",text:"实线"},{value:"dashed",text:"破折线"},{value:"dotted",text:"点状线"}]},borderColor:{...At,component:"color-picker",text:"边框颜色"},borderWidth:{...At,component:"a-slider",intialTransform:e=>parseInt(e),afterTransform:e=>e+"px",text:"边框宽度",extraProps:{min:0,max:20}},borderRadius:{...At,component:"a-slider",intialTransform:e=>parseInt(e),afterTransform:e=>e+"px",text:"边框圆角",extraProps:{min:0,max:200}},opacity:{...At,component:"a-slider",text:"透明度",intialTransform:e=>e?100*e:100,afterTransform:e=>e/100,extraProps:{min:0,max:100,reverse:!0}},boxShadow:{...At,component:"shadow-picker"},position:{...At,component:"a-select",subComponent:"a-select-option",text:"定位",options:[{value:"",text:"默认"},{value:"absolute",text:"绝对定位"}]},left:{...Nt,text:"X轴坐标"},top:{...Nt,text:"Y轴坐标"},imageSrc:{...At,component:"image-processer"},backgroundImage:{...At,component:"background-processer",intialTransform:e=>{if(e){const t=e.match(/\((.*?)\)/);return t&&t.length>1?t[1].replace(/('|")/g,""):""}return""},afterTransform:e=>e?`url('${e}')`:"",extraProps:{ratio:8/15,showDelete:!0},extraEvent:"uploaded"},backgroundSize:{...At,component:"a-select",subComponent:"a-select-option",text:"背景大小",options:[{value:"contain",text:"自动缩放"},{value:"cover",text:"自动填充"},{value:"",text:"默认"}]},backgroundRepeat:{...At,component:"a-select",subComponent:"a-select-option",text:"背景重复",options:[{value:"no-repeat",text:"无重复"},{value:"repeat-x",text:"X轴重复"},{value:"repeat-y",text:"Y轴重复"},{value:"repeat",text:"全部重复"}]}};var Mt=Bt;const Ht=["value"];function $t(e,t,c,n,o,l){return Object(a["J"])(),Object(a["m"])("textarea",Object(a["y"])({class:"ant-input",rows:"3"},e.$attrs,{value:e.value,onInput:t[0]||(t[0]=(...t)=>e.onInput&&e.onInput(...t)),onCompositionstart:t[1]||(t[1]=(...t)=>e.onStart&&e.onStart(...t)),onCompositionend:t[2]||(t[2]=(...t)=>e.onEnd&&e.onEnd(...t)),ref:"areaRef"}),"\r\n  ",16,Ht)}var Kt=Object(a["r"])({props:{value:{type:String,required:!0}},name:"TextAreaFix",emits:["change"],setup(e,t){const c=Object(a["O"])(null);let n=!1;const o=e=>{n||t.emit("change",e)},l=()=>{n=!0},i=()=>{n=!1,c.value&&c.value.dispatchEvent(new Event("input"))};return{areaRef:c,onInput:o,onStart:l,onEnd:i}}});const Vt=X()(Kt,[["render",$t]]);var Qt=Vt;const Gt={class:"lego-color-picker"},Xt={class:"native-color-container"},Yt=["value"],Zt={class:"picked-color-list"},ec=["onClick"],tc={key:1,class:"color-item transparnet-back"};function cc(e,t,c,n,o,l){return Object(a["J"])(),Object(a["m"])("div",Gt,[Object(a["n"])("div",Xt,[Object(a["n"])("input",{type:"color",value:e.value,onInput:t[0]||(t[0]=t=>e.onChange(t.target.value))},null,40,Yt)]),Object(a["n"])("ul",Zt,[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.colors,(t,c)=>(Object(a["J"])(),Object(a["m"])("li",{key:c,onClick:Object(a["hb"])(c=>e.onChange(t),["prevent"])},[t.startsWith("#")?(Object(a["J"])(),Object(a["m"])("div",{key:0,style:Object(a["B"])({backgroundColor:t}),class:"color-item"},null,4)):(Object(a["J"])(),Object(a["m"])("div",tc))],8,ec))),128))])])}const ac=["#ffffff","#f5222d","#fa541c","#fadb14","#52c41a","#1890ff","#722ed1","#8c8c8c","#000000",""];var nc=Object(a["r"])({props:{value:{type:String},colors:{type:Array,default:ac}},emits:["change"],setup(e,t){const c=e=>{t.emit("change",e)};return{onChange:c}}});c("8fb3");const oc=X()(nc,[["render",cc]]);var lc=oc;function ic(e,t,c,n,o,l){const i=Object(a["S"])("a-button"),s=Object(a["S"])("a-tooltip");return Object(a["J"])(),Object(a["m"])("div",{class:"icon-template",onClick:t[0]||(t[0]=Object(a["hb"])((...t)=>e.handleClick&&e.handleClick(...t),["prevent"]))},[Object(a["q"])(s,null,{title:Object(a["fb"])(()=>[Object(a["p"])(Object(a["W"])(e.tip),1)]),default:Object(a["fb"])(()=>[Object(a["q"])(i,{type:e.checked?"primary":"",shape:"circle"},{icon:Object(a["fb"])(()=>[(Object(a["J"])(),Object(a["k"])(Object(a["U"])(e.iconName)))]),_:1},8,["type"])]),_:1})])}var sc=c("9b01"),rc=c("0c63"),bc=c("59a3"),dc=Object(a["r"])({components:{BoldOutlined:sc["a"],ItalicOutlined:rc["a"],UnderlineOutlined:bc["a"]},props:{iconName:{type:String,required:!0},checked:{type:Boolean,default:!1},tip:{type:String}},emits:["change"],setup(e,t){const c=()=>{t.emit("change",!e.checked)};return{handleClick:c}}});const pc=X()(dc,[["render",ic]]);var uc=pc;const Oc={class:"component-shadow-picker"},jc={class:"shadow-item"},mc=Object(a["n"])("span",null,"阴影颜色:",-1),fc={class:"shadow-component"},vc={class:"shadow-item"},gc=Object(a["n"])("span",null,"阴影大小:",-1),hc={class:"shadow-component"},yc={class:"shadow-item"},kc=Object(a["n"])("span",null,"阴影模糊:",-1),xc={class:"shadow-component"};function Cc(e,t,c,n,o,l){const i=Object(a["S"])("color-picker"),s=Object(a["S"])("a-slider");return Object(a["J"])(),Object(a["m"])("div",Oc,[Object(a["n"])("div",jc,[mc,Object(a["n"])("div",fc,[Object(a["q"])(i,{value:e.values[3],onChange:t[0]||(t[0]=t=>{e.updateValue(t,3)})},null,8,["value"])])]),Object(a["n"])("div",vc,[gc,Object(a["n"])("div",hc,[Object(a["q"])(s,{value:parseInt(e.values[0]),min:0,max:20,onChange:t[1]||(t[1]=t=>{e.updateValue(t,[0,1])})},null,8,["value"])])]),Object(a["n"])("div",yc,[kc,Object(a["n"])("div",xc,[Object(a["q"])(s,{value:parseInt(e.values[2]),min:0,max:20,onChange:t[2]||(t[2]=t=>{e.updateValue(t,2)})},null,8,["value"])])])])}var Sc=Object(a["r"])({props:{value:{type:String,required:!0}},components:{ColorPicker:lc},emits:["change"],setup(e,t){const c=Object(a["i"])(()=>e.value.split(" ")),n=(e,n)=>{const o=Object(a["i"])(()=>c.value.map((t,c)=>"number"===typeof n&&c===n||Array.isArray(n)&&n.includes(c)?"number"===typeof e?e+"px":e:t));t.emit("change",o.value.join(" "))};return{values:c,updateValue:n}}});c("4685");const qc=X()(Sc,[["render",Cc]]);var wc=qc;const _c={class:"image-processer"},Uc={class:"image-cropper"},Tc=["src"],Ec={class:"image-process"},Ic={class:"uploader-container"},Pc={class:"uploader-container"};function Jc(e,t,c,n,o,l){const i=Object(a["S"])("a-modal"),s=Object(a["S"])("UploadOutlined"),r=Object(a["S"])("a-button"),b=Object(a["S"])("LoadingOutlined"),d=Object(a["S"])("uploader"),p=Object(a["S"])("ScissorOutlined"),u=Object(a["S"])("DeleteOutlined");return Object(a["J"])(),Object(a["m"])("div",_c,[Object(a["q"])(i,{title:"裁剪图片",visible:e.showModal,"onUpdate:visible":t[0]||(t[0]=t=>e.showModal=t),onOk:e.handleOk,onCancel:t[1]||(t[1]=t=>e.showModal=!1),okText:"确认",cancelText:"取消"},{default:Object(a["fb"])(()=>[Object(a["n"])("div",Uc,[Object(a["n"])("img",{src:e.baseImageUrl,id:"processed-image"},null,8,Tc)])]),_:1},8,["visible","onOk"]),Object(a["n"])("div",{class:Object(a["A"])(["image-preview",{extraHeight:e.showDelete}]),style:Object(a["B"])({backgroundImage:e.backgrondUrl})},null,6),Object(a["n"])("div",Ec,[Object(a["q"])(d,{action:"/utils/upload-img",onFileUploaded:e.handleFileUploaded,beforeUpload:e.commonUploadCheck},{loading:Object(a["fb"])(()=>[Object(a["n"])("div",Pc,[Object(a["q"])(r,null,{icon:Object(a["fb"])(()=>[Object(a["q"])(b)]),default:Object(a["fb"])(()=>[Object(a["p"])("上传中 ")]),_:1})])]),uploaded:Object(a["fb"])(()=>[Object(a["q"])(r,null,{icon:Object(a["fb"])(()=>[Object(a["q"])(s)]),default:Object(a["fb"])(()=>[Object(a["p"])("更换图片 ")]),_:1})]),default:Object(a["fb"])(()=>[Object(a["n"])("div",Ic,[Object(a["q"])(r,null,{icon:Object(a["fb"])(()=>[Object(a["q"])(s)]),default:Object(a["fb"])(()=>[Object(a["p"])("更换图片 ")]),_:1})])]),_:1},8,["onFileUploaded","beforeUpload"]),Object(a["q"])(r,{onClick:t[2]||(t[2]=t=>e.showModal=!0)},{icon:Object(a["fb"])(()=>[Object(a["q"])(p)]),default:Object(a["fb"])(()=>[Object(a["p"])("裁剪图片 ")]),_:1}),e.showDelete?(Object(a["J"])(),Object(a["k"])(r,{key:0,type:"danger",onClick:e.handleDelete},{icon:Object(a["fb"])(()=>[Object(a["q"])(u)]),default:Object(a["fb"])(()=>[Object(a["p"])("删除图片 ")]),_:1},8,["onClick"])):Object(a["l"])("",!0)])])}var Lc=c("f743"),Rc=c.n(Lc),Fc=Object(a["r"])({props:{value:{type:String,required:!0},ratio:{type:Number},showDelete:{type:Boolean,default:!1}},components:{Uploader:Z},emits:["change","uploaded"],setup(e,t){const c=Object(a["O"])(!1);let n,o;Object(a["db"])(c,t=>{t?Object(a["z"])(()=>{const t=document.getElementById("processed-image");o=new Rc.a(t,{checkCrossOrigin:!1,crop(e){const{x:t,y:c,width:a,height:o}=e.detail;n={x:Math.floor(t),y:Math.floor(c),width:Math.floor(a),height:Math.floor(o)}},...e.ratio&&{aspectRatio:e.ratio}})}):o&&o.destroy()});const l=Object(a["i"])(()=>e.value.split("?")[0]),i=Object(a["i"])(()=>`url(${e.value})`),s=()=>{const{x:e,y:a,width:o,height:i}=n,s=l.value+`?x-oss-process=image/crop,x_${e},y_${a},w_${o},h_${i}`;t.emit("change",s),c.value=!1},r=e=>{q["a"].success("上传成功"),t.emit("change",e.data.urls[0]),t.emit("uploaded",e)},b=()=>{t.emit("change","")};return{showModal:c,handleOk:s,baseImageUrl:l,backgrondUrl:i,commonUploadCheck:D["b"],handleFileUploaded:r,handleDelete:b}}});c("fdca");const Wc=X()(Fc,[["render",Jc]]);var Ac=Wc;const Nc={class:"background-processer"};function Dc(e,t,c,n,o,l){const i=Object(a["S"])("styled-uploader"),s=Object(a["S"])("image-processer");return Object(a["J"])(),Object(a["m"])("div",Nc,[e.value?(Object(a["J"])(),Object(a["k"])(s,{key:1,value:e.value,onChange:e.updateUrl,ratio:e.ratio,showDelete:!0,onUploaded:e.triggerUploaded},null,8,["value","onChange","ratio","onUploaded"])):(Object(a["J"])(),Object(a["k"])(i,{key:0,onFileUploaded:e.handleFileUploaded},null,8,["onFileUploaded"]))])}var zc=Object(a["r"])({props:{value:{type:String,required:!0},ratio:{type:Number}},components:{ImageProcesser:Ac,StyledUploader:ce},emits:["change","uploaded"],setup(e,t){const c=e=>{q["a"].success("上传成功"),t.emit("change",e.data.urls[0]),t.emit("uploaded",e)},a=e=>{t.emit("change",e)},n=e=>{t.emit("uploaded",e)};return{handleFileUploaded:c,commonUploadCheck:D["b"],updateUrl:a,triggerUploaded:n}}});c("e321");const Bc=X()(zc,[["render",Dc]]);var Mc=Bc;const Hc=Object(a["r"])({props:{vNode:{type:[Object,String],required:!0}},render(){return Object(a["x"])(this.vNode)?this.vNode:Object(a["u"])("div",this.vNode)}});var $c=Hc,Kc=Object(a["r"])({props:{props:{type:Object,required:!0},mutationName:{type:String,default:"updateComponent"},mutationExtraData:{type:Object}},components:{ColorPicker:lc,IconSwitch:uc,ShadowPicker:wc,ImageProcesser:Ac,TextareaFix:Qt,BackgroundProcesser:Mc,RenderVnode:$c},emits:["updated"],setup(e,t){const{commit:c}=Object(C["b"])(),n=t=>{const a=e.mutationExtraData?{...t,...e.mutationExtraData}:t;c(e.mutationName,a)},o=Object(a["i"])(()=>Object(Ut["a"])(e.props,(c,a)=>{const{component:o,intialTransform:l,afterTransform:i,eventName:s,text:r,valueProp:b,options:d,subComponent:p,extraProps:u={},parent:O,extraEvent:j}=Mt[a];let m=!1;return O&&(m=!e.props[O]),{key:a,component:o,text:r,valueProp:b,isHidden:m,value:l(c),extraProps:u,events:{[s]:e=>{n({value:i(e),key:a})},...j&&{[j]:e=>{t.emit("updated",{data:e,key:a})}}},options:d,subComponent:p}}));return{maps:Mt,handleCommit:n,finalProps:o}}});c("59f1");const Vc=X()(Kc,[["render",Wt]]);var Qc=Vc;const Gc=[{text:"尺寸",items:["height","width","paddingLeft","paddingRight","paddingTop","paddingBottom"]},{text:"边框",items:["borderStyle","borderColor","borderWidth","borderRadius"]},{text:"阴影与透明度",items:["opacity","boxShadow"]},{text:"位置",items:["left","top"]},{text:"事件功能",items:["actionType","url"]}];var Xc=Object(a["r"])({props:{props:{type:Object,required:!0},groups:{type:Array,default:Gc}},components:{PropTable:Qc},setup(e){const t=Object(a["O"])(e.groups.length?e.groups[0].text:""),c=Object(a["i"])(()=>{const c=Gc.reduce((e,t)=>[...e,...t.items],[]);c.push("tag"),c.push("right"),c.push("position");const a=Object(Jt["a"])(Object.keys(e.props),c);return t.value="基本属性",[{text:"基本属性",items:a},...e.groups]}),n=Object(a["i"])(()=>c.value.map(t=>{const c={};return t.items.forEach(t=>{c[t]=e.props[t]}),{...t,props:c}}));return{currentKey:t,editGroups:n}}});const Yc=X()(Xc,[["render",Pt]]);var Zc=Yc;const ea=["onClick"];function ta(e,t,c,n,o,l){const i=Object(a["S"])("EyeOutlined"),s=Object(a["S"])("EyeInvisibleOutlined"),r=Object(a["S"])("a-button"),b=Object(a["S"])("a-tooltip"),d=Object(a["S"])("UnlockOutlined"),p=Object(a["S"])("LockOutlined"),u=Object(a["S"])("input-edit"),O=Object(a["S"])("DragOutlined"),j=Object(a["S"])("draggable");return Object(a["J"])(),Object(a["k"])(j,{list:e.list,handle:".handle",class:"ant-list-items ant-list-bordered","ghost-class":"ghost"},{default:Object(a["fb"])(()=>[(Object(a["J"])(!0),Object(a["m"])(a["b"],null,Object(a["Q"])(e.list,t=>(Object(a["J"])(),Object(a["m"])("li",{class:Object(a["A"])(["ant-list-item",{active:t.id===e.selectedId}]),key:t.id,onClick:c=>e.handleClick(t.id)},[Object(a["q"])(b,{title:t.isHidden?"显示":"隐藏"},{default:Object(a["fb"])(()=>[Object(a["q"])(r,{shape:"circle",onClick:c=>e.handleChange(t.id,"isHidden",!t.isHidden)},Object(a["o"])({_:2},[t.isHidden?{name:"icon",fn:Object(a["fb"])(()=>[Object(a["q"])(i)]),key:"0"}:{name:"icon",fn:Object(a["fb"])(()=>[Object(a["q"])(s)]),key:"1"}]),1032,["onClick"])]),_:2},1032,["title"]),Object(a["q"])(b,{title:t.isLocked?"解锁":"锁定"},{default:Object(a["fb"])(()=>[Object(a["q"])(r,{shape:"circle",onClick:c=>e.handleChange(t.id,"isLocked",!t.isLocked)},Object(a["o"])({_:2},[t.isLocked?{name:"icon",fn:Object(a["fb"])(()=>[Object(a["q"])(d)]),key:"0"}:{name:"icon",fn:Object(a["fb"])(()=>[Object(a["q"])(p)]),key:"1"}]),1032,["onClick"])]),_:2},1032,["title"]),Object(a["q"])(u,{value:t.layerName,onClicked:e.handleClick,onChange:c=>{e.handleChange(t.id,"layerName",c)}},{default:Object(a["fb"])(()=>[Object(a["n"])("span",null,Object(a["W"])(t.layerName),1)]),_:2},1032,["value","onClicked","onChange"]),Object(a["q"])(b,{title:"拖动排序"},{default:Object(a["fb"])(()=>[Object(a["q"])(r,{shape:"circle",class:"handle"},{icon:Object(a["fb"])(()=>[Object(a["q"])(O)]),_:1})]),_:1})],10,ea))),128))]),_:1},8,["list"])}var ca=c("e98e");function aa(e,t,c,n,o,l){const i=Object(a["S"])("a-input");return Object(a["J"])(),Object(a["m"])("div",{class:"inline-edit",onClick:t[1]||(t[1]=Object(a["hb"])((...t)=>e.handleClick&&e.handleClick(...t),["stop"])),ref:"wrapper"},[e.isEditing?(Object(a["J"])(),Object(a["k"])(i,{key:0,value:e.innerValue,"onUpdate:value":t[0]||(t[0]=t=>e.innerValue=t),class:Object(a["A"])({"input-error":!e.validateCheck}),placeholder:"文本不能为空"},null,8,["value","class"])):Object(a["R"])(e.$slots,"default",{key:1})],512)}var na=c("d489");na["a"].filter=()=>!0;const oa=(e,t,c={})=>{Object(a["G"])(()=>{Object(na["a"])(e,c,t)}),Object(a["H"])(()=>{na["a"].unbind(e,t)})};var la=oa;const ia=e=>{const t=Object(a["O"])(!1),c=c=>{e.value&&c.target&&(e.value.contains(c.target)?t.value=!1:t.value=!0)};return Object(a["G"])(()=>{document.addEventListener("click",c)}),Object(a["H"])(()=>{document.removeEventListener("click",c)}),t};var sa=ia,ra=Object(a["r"])({name:"inline-edit",props:{value:{type:String,required:!0}},emits:["change","clicked"],setup(e,t){const c=Object(a["O"])(e.value),n=Object(a["O"])(!1),o=Object(a["O"])(null),l=Object(a["O"])(!1),i=sa(o);Object(a["db"])(()=>e.value,()=>{c.value=e.value});const s=()=>{setTimeout(()=>{l.value=!0,t.emit("clicked")},100)},r=Object(a["i"])(()=>""!==c.value.trim());return Object(a["db"])(i,e=>{r.value&&e&&l.value&&(l.value=!1,t.emit("change",c),n.value=!1,i.value=!1)}),la("enter, return",()=>{r.value&&l.value&&(l.value=!1,t.emit("change",c))}),la("esc",()=>{l.value&&(l.value=!1,c.value=e.value)}),{handleClick:s,innerValue:c,isEditing:l,wrapper:o,validateCheck:r}}});c("6016");const ba=X()(ra,[["render",aa]]);var da=ba,pa=Object(a["r"])({props:{list:{type:Array,required:!0},selectedId:{type:String,required:!0}},emits:["select","change"],components:{Draggable:ca["a"],InputEdit:da},setup(e,t){const c=e=>{t.emit("select",e)},a=(e,c,a)=>{const n={id:e,key:c,value:a};t.emit("change",n)};return{handleClick:c,handleChange:a}}});c("304c");const ua=X()(pa,[["render",ta],["__scopeId","data-v-2d7a0f13"]]);var Oa=ua,ja=c("9f73");function ma(e,t){la(e,(e,c)=>{const a=e.target.tagName,n="TEXTAREA"===a||"INPUT"===a;n||(e.preventDefault(),t(e,c))})}function fa(){const e=Object(C["b"])(),t=Object(a["i"])(()=>e.state.editor.currentElement),c=Te(t);ma("ctrl+c, command+c",()=>{c.copy()}),ma("backspace, delete",()=>{c.delete()}),ma("ctrl+v, command+v",e=>{c.paste()}),ma("esc",()=>{c.cancel()}),ma("ctrl+z, command+z",()=>{c.undo()}),ma("ctrl+shift+z, command+shift+z",()=>{c.redo()}),ma("up",()=>{c.move("Up",1)}),ma("down",()=>{c.move("Down",1)}),ma("left",()=>{c.move("Left",1)}),ma("right",()=>{c.move("Right",1)}),ma("shift+up",()=>{c.move("Up",10)}),ma("shift+down",()=>{c.move("Down",10)}),ma("shift+left",()=>{c.move("Left",10)}),ma("shift+right",()=>{c.move("Right",10)})}var va=c("9897"),ga=Object(a["r"])({name:"Home",components:{EditWrapper:Qe,ComponentsList:Ct,EditGroup:Zc,LayerList:Oa,PropsTable:Qc,PublishForm:se,ChannelForm:xe,ContextMenu:It,UserProfile:ja["a"],InputEdit:da,HistoryArea:Je},setup(){const e=Object(C["b"])(),t=Object(S["d"])(),c=Object(a["i"])(()=>e.state.editor.components),n=Object(a["i"])(()=>e.state.editor.currentElement),o=Object(a["i"])(()=>e.state.editor.currentEditing),l=Object(a["i"])(()=>e.getters.getCurrentElement),i=Object(a["i"])(()=>e.state.user),s=Object(a["i"])(()=>e.state.editor.page),r=Object(a["i"])(()=>e.state.editor.isDirty),b=Object(a["i"])(()=>e.state.editor.isChangedNotPublished),d=Object(a["i"])(()=>e.state.status),p=Object(a["O"])(!1),u=Object(a["O"])(!1),O=Object(a["O"])(!1),j=Object(a["O"])("component"),m=Object(a["O"])(!1),f=Object(a["O"])(!1);fa(),Object(va["a"])();const v=t.params.id;let g;const h=Object(a["i"])(()=>`${oe["baseH5URL"]}/p/preview/${s.value.id}-${s.value.uuid}`),y=(t=!1)=>(m.value=!0,e.dispatch("saveWorkT",{id:v}).then(()=>{t&&q["a"].success("保存成功",2)}).finally(()=>{m.value=!1})),k=()=>{y(!0).then(()=>{p.value=!0})},x=async(t=!1)=>{e.commit("setActive",""),j.value="component",O.value=!0,await Object(a["z"])();try{const c=await Object(D["i"])("canvas-area");c&&e.commit("updatePage",{key:"coverImg",value:c.data.urls[0]})}catch(c){console.error(c)}finally{O.value=!1,t&&y()}},T=async()=>{f.value=!0;try{await x()}catch(t){console.error(t)}finally{await e.dispatch("saveAndPublishWork",{id:v}),p.value=!1,u.value=!0,f.value=!1}};Object(a["G"])(()=>{e.commit("resetEditor"),v&&e.dispatch("getWork",v),g=setInterval(()=>{r.value&&y()},3e4)}),Object(a["H"])(()=>{clearInterval(g)}),Object(S["c"])((e,t,c)=>{r.value?w["a"].confirm({title:"作品还未保存，是否保存？",okText:"保存",okType:"primary",cancelText:"不保存",onOk:()=>{x(!0).then(()=>{c()})},onCancel(){c()}}):b.value?x(!0).then(()=>{c()}):c()}),Object(a["db"])(j,t=>{"component"!==t&&e.commit("setActive","")});const E=t=>{e.commit("addComponentToEditor",{name:t.name,props:{...t.props}})},I=(t,c=!1)=>{e.commit("setActive",t),c||(j.value="component")},P=t=>{e.commit("setEditing",t),j.value="component",Object(a["z"])(()=>{const e=document.querySelector("#item-text textarea");e&&e.focus()})},J=t=>{e.commit("updateComponent",t)},L=t=>{const c=t.target;c.classList.contains("body-container")&&(e.commit("setActive",""),j.value="page")},R=t=>{const c=t.target;c.classList.contains("preview-container")&&(e.commit("setActive",""),j.value="page")},F=t=>{const{id:c}=t,a=Object(_["a"])(Object(U["a"])(t,(e,t)=>"id"!==t),e=>e+"px"),n=Object.keys(a),o=Object.values(a);e.commit("updateComponent",{key:n,value:o,id:c,isProps:!0})},W=t=>{e.commit("updatePage",{key:"title",value:t}),Object(a["z"])(()=>{y()})},A=t=>{"backgroundImage"===t.key&&Object(D["e"])(t.data.file).then(t=>{const c=375,a=t.height/t.width;a>1&&e.commit("updatePage",{key:"height",value:a*c+"px",level:"props"})})};return{visible:p,showModal:u,onItemCreated:E,handleChange:J,components:c,setActive:I,setEditing:P,currentId:n,currentElement:l,currentEditing:o,mapPropsToComponents:Mt,updatePosition:F,setPageSetting:L,activePanel:j,pageState:s,userInfo:i,globalStatus:d,saveWork:y,previewWork:k,publishWork:T,titleChange:W,clearSelection:R,previewURL:h,adjustHeightOnUpload:A,canvasFix:O,isSaving:m,isPublishing:f}}});c("ad7b");const ha=X()(ga,[["render",x]]);t["default"]=ha},"51af":function(e,t,c){"use strict";c("8c73")},5517:function(e,t,c){},"59f1":function(e,t,c){"use strict";c("b70d")},"5a44":function(e,t,c){},"5ae0":function(e,t,c){},"5d3d":function(e,t,c){},"5e22":function(e,t,c){},6016:function(e,t,c){"use strict";c("8d66")},6067:function(e,t,c){"use strict";c("d494")},"610d":function(e,t,c){},"734c":function(e,t,c){"use strict";c("cdc9")},8762:function(e,t,c){"use strict";c("5ae0")},"8c73":function(e,t,c){},"8d66":function(e,t,c){},"8e06":function(e,t,c){"use strict";c("d6fc")},"8fb3":function(e,t,c){"use strict";c("610d")},ad7b:function(e,t,c){"use strict";c("5d3d")},aeb2:function(e,t,c){"use strict";c("47f1")},b70d:function(e,t,c){},bdcd:function(e,t,c){},c303:function(e,t,c){},c4a4:function(e,t,c){"use strict";c("5517")},cdc9:function(e,t,c){},d494:function(e,t,c){},d6fc:function(e,t,c){},e321:function(e,t,c){"use strict";c("c303")},fdca:function(e,t,c){"use strict";c("5e22")}}]);
//# sourceMappingURL=editor.7f55ca14.js.map